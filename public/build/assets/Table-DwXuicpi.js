import{r as u,a as E,k as w,K as v,j as e,$ as j}from"./app-S1NbybTy.js";import{a as T,b as I,B as $}from"./AuthenticatedLayout-np5EyWr9.js";import{D as V}from"./DashboardLayout-DFavhX3m.js";import{T as B,a as F,b as g,c as C,d as z,e as f}from"./table-B8RJ-R1S.js";import{I as H}from"./input-BoCdPJ-m.js";import{D as L,p as q,a as A,b as R,c as k,d as Q,e as K,f as M}from"./dialog-DxnoNPjn.js";import{T as P}from"./trash-Dj9fHyPx.js";import{S as U}from"./square-pen-BqRev5e6.js";import"./transition-C99L9tC2.js";import"./index-DlPfhbBw.js";import"./index-wSg68zUq.js";import"./x-ByVxXwLa.js";const W=()=>{const[t,r]=u.useState(!1),[o,p]=u.useState(!1),[n,c]=u.useState("");return{deleteDataValue:async(x,d)=>{try{r(!0),await E.delete(`/delete-value/${x}`),w.success("Data deleted successfully"),d==null||d()}catch(m){p(!0),c(m.message||"Failed to delete data"),w.error("Failed to delete data")}finally{r(!1)}},isDeleting:t,isError:o,error:n}},le=({entity_detail:t,values:r})=>{var N;const o=v().props.current_project,p=o.uuid,n=v().props.auth.user,[c,b]=u.useState(""),x=r.data.filter(s=>t.fields.some(l=>{var i,a;return(a=(i=s.fields[l.title])==null?void 0:i.v)==null?void 0:a.toString().toLowerCase().includes(c.toLowerCase())})),{deleteDataValue:d,isDeleting:m}=W(),S=async s=>{await d(s,()=>{window.location.reload()})};return e.jsx(V,{children:e.jsxs("div",{className:"ps-2 pe-7",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"font-bold text-2xl",children:T(t.name)}),e.jsx(j,{href:`/p/${p}/table/${t.uuid}/new`,className:I({size:"sm"}),children:"+ Add New"})]}),e.jsx("div",{className:"mt-4 mb-2",children:e.jsx(H,{type:"text",placeholder:"Search...",value:c,onChange:s=>b(s.target.value)})}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs(B,{className:"text-xs min-w-full border border-gray-200 rounded-lg",children:[e.jsx(F,{className:"bg-gray-100",children:e.jsxs(g,{children:[(N=t.fields)==null?void 0:N.map(s=>e.jsx(C,{className:"font-semibold",children:T(s.title)},s.id)),e.jsx(C,{className:"text-right font-semibold",children:"Actions"})]})}),e.jsx(z,{children:x.length>0?x.map(s=>{var l;return e.jsxs(g,{className:"hover:bg-gray-50",children:[(l=t.fields)==null?void 0:l.map(i=>{var D,y;let a=(D=s.fields[i.title])==null?void 0:D.v,h=(y=s.fields[i.title])==null?void 0:y.type;return e.jsx(f,{className:"py-2 px-4",children:h==="Image"&&a?e.jsx("img",{src:a,alt:"Uploaded",className:"w-16 h-16 object-cover rounded border"}):h==="Boolean"?e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a==1?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:a==1?"Yes":"No"}):h==="Email"?e.jsx("a",{href:`mailto:${a}`,className:"text-blue-600 underline hover:text-blue-800",children:a}):h==="Rich Text (Blocks)"?e.jsx("div",{className:"max-w-xs text-xs line-clamp-2 overflow-hidden text-ellipsis",dangerouslySetInnerHTML:{__html:a||"-"}}):a||"-"},i.title)}),e.jsx(f,{children:e.jsx("div",{className:"flex justify-end px-2",children:(s.user_id===n.id||o.user_id===n.id)&&e.jsxs(e.Fragment,{children:[e.jsxs(L,{children:[e.jsx(q,{asChild:!0,children:e.jsx("button",{className:"text-red-600 hover:text-red-800 me-2",children:e.jsx(P,{size:15})})}),e.jsxs(A,{className:"sm:max-w-md",children:[e.jsxs(R,{children:[e.jsx(k,{children:"Delete Data?"}),e.jsx(Q,{children:"Are you sure you want to delete this data? This action cannot be undone."})]}),e.jsxs(K,{children:[e.jsx(M,{asChild:!0,children:e.jsx($,{variant:"secondary",children:"Cancel"})}),e.jsx($,{variant:"destructive",onClick:()=>S(s.id),disabled:m,children:m?"Deleting...":"Delete"})]})]})]}),e.jsx(j,{href:`/p/${o.uuid}/table/${t.uuid}/edit/${s.id}`,className:"text-orange-600 hover:text-orange-800",children:e.jsx(U,{size:15})})]})})})]},s.id)}):e.jsx(g,{children:e.jsx(f,{colSpan:t.fields.length+1,className:"text-center py-4 text-gray-500",children:"No data found"})})})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-[10px] text-gray-600",children:["Showing ",r.from||0," to ",r.to," of"," ",r.total," entries"]}),e.jsx("div",{className:"flex space-x-1",children:r.links.map((s,l)=>e.jsx(j,{href:s.url||"#",className:`px-3 py-2 text-[10px] rounded-md border ${s.active?"bg-primary text-white":"bg-white text-gray-700 hover:bg-gray-100"} ${s.url?"":"pointer-events-none text-gray-400"}`,children:s.label.replace("&laquo;","«").replace("&raquo;","»")},l))})]})]})})};export{le as default};
