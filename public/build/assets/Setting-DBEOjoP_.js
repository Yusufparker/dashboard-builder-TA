import{r as i,j as e,K as O,a as q,k as N,$ as U}from"./app-CW2wVgSQ.js";import{u as X,a as G}from"./index.esm-pZyzm4ua.js";import{c as A,g as Z,u as J,e as L,B as E}from"./AuthenticatedLayout-D35cYHGr.js";import{c as Q,u as Y,a as $,I as S}from"./input-YPxtpf5a.js";import{u as ee}from"./index-BLNK7vmU.js";import{u as te,C as se}from"./index-CvQAXmwg.js";import{P as ae}from"./index-TZdzqAYH.js";import"./index-CaM0zfBP.js";import{L as P}from"./label-oRbyoOWi.js";import{T as re}from"./trash-De3rTpld.js";import{D as ne}from"./DashboardLayout-DLZGk48D.js";import{M as oe}from"./move-left-BAUMJGWM.js";import"./transition-CrovLz_c.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],ce=A("Clipboard",ie);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],de=A("Plus",le);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],ue=A("RefreshCcw",pe);var B=i.forwardRef((t,a)=>{const{children:s,...n}=t,c=i.Children.toArray(s),o=c.find(he);if(o){const p=o.props.children,d=c.map(h=>h===o?i.Children.count(p)>1?i.Children.only(null):i.isValidElement(p)?p.props.children:null:h);return e.jsx(R,{...n,ref:a,children:i.isValidElement(p)?i.cloneElement(p,void 0,d):null})}return e.jsx(R,{...n,ref:a,children:s})});B.displayName="Slot";var R=i.forwardRef((t,a)=>{const{children:s,...n}=t;if(i.isValidElement(s)){const c=xe(s),o=fe(n,s.props);return s.type!==i.Fragment&&(o.ref=a?Z(a,c):c),i.cloneElement(s,o)}return i.Children.count(s)>1?i.Children.only(null):null});R.displayName="SlotClone";var me=({children:t})=>e.jsx(e.Fragment,{children:t});function he(t){return i.isValidElement(t)&&t.type===me}function fe(t,a){const s={...a};for(const n in a){const c=t[n],o=a[n];/^on[A-Z]/.test(n)?c&&o?s[n]=(...d)=>{o(...d),c(...d)}:c&&(s[n]=c):n==="style"?s[n]={...c,...o}:n==="className"&&(s[n]=[c,o].filter(Boolean).join(" "))}return{...t,...s}}function xe(t){var n,c;let a=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,s=a&&"isReactWarning"in a&&a.isReactWarning;return s?t.ref:(a=(c=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:c.get,s=a&&"isReactWarning"in a&&a.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var be=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],F=be.reduce((t,a)=>{const s=i.forwardRef((n,c)=>{const{asChild:o,...p}=n,d=o?B:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...p,ref:c})});return s.displayName=`Primitive.${a}`,{...t,[a]:s}},{}),I="Checkbox",[ye,Oe]=Q(I),[ke,ge]=ye(I),V=i.forwardRef((t,a)=>{const{__scopeCheckbox:s,name:n,checked:c,defaultChecked:o,required:p,disabled:d,value:h="on",onCheckedChange:j,form:u,...y}=t,[m,b]=i.useState(null),k=J(a,r=>b(r)),g=i.useRef(!1),C=m?u||!!m.closest("form"):!0,[f=!1,v]=Y({prop:c,defaultProp:o,onChange:j}),w=i.useRef(f);return i.useEffect(()=>{const r=m==null?void 0:m.form;if(r){const l=()=>v(w.current);return r.addEventListener("reset",l),()=>r.removeEventListener("reset",l)}},[m,v]),e.jsxs(ke,{scope:s,state:f,disabled:d,children:[e.jsx(F.button,{type:"button",role:"checkbox","aria-checked":x(f)?"mixed":f,"aria-required":p,"data-state":H(f),"data-disabled":d?"":void 0,disabled:d,value:h,...y,ref:k,onKeyDown:$(t.onKeyDown,r=>{r.key==="Enter"&&r.preventDefault()}),onClick:$(t.onClick,r=>{v(l=>x(l)?!0:!l),C&&(g.current=r.isPropagationStopped(),g.current||r.stopPropagation())})}),C&&e.jsx(je,{control:m,bubbles:!g.current,name:n,value:h,checked:f,required:p,disabled:d,form:u,style:{transform:"translateX(-100%)"},defaultChecked:x(o)?!1:o})]})});V.displayName=I;var T="CheckboxIndicator",z=i.forwardRef((t,a)=>{const{__scopeCheckbox:s,forceMount:n,...c}=t,o=ge(T,s);return e.jsx(ae,{present:n||x(o.state)||o.state===!0,children:e.jsx(F.span,{"data-state":H(o.state),"data-disabled":o.disabled?"":void 0,...c,ref:a,style:{pointerEvents:"none",...t.style}})})});z.displayName=T;var je=t=>{const{control:a,checked:s,bubbles:n=!0,defaultChecked:c,...o}=t,p=i.useRef(null),d=ee(s),h=te(a);i.useEffect(()=>{const u=p.current,y=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(y,"checked").set;if(d!==s&&b){const k=new Event("click",{bubbles:n});u.indeterminate=x(s),b.call(u,x(s)?!1:s),u.dispatchEvent(k)}},[d,s,n]);const j=i.useRef(x(s)?!1:s);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:c??j.current,...o,tabIndex:-1,ref:p,style:{...t.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function x(t){return t==="indeterminate"}function H(t){return x(t)?"indeterminate":t?"checked":"unchecked"}var K=V,ve=z;const W=i.forwardRef(({className:t,...a},s)=>e.jsx(K,{ref:s,className:L("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:e.jsx(ve,{className:L("flex items-center justify-center text-current"),children:e.jsx(se,{className:"h-4 w-4"})})}));W.displayName=K.displayName;const Ce=({setting:t})=>{const a=O().props.current_project.uuid,{register:s,handleSubmit:n,watch:c,setValue:o,control:p}=X({defaultValues:{is_api_enabled:!!t.is_api_enabled,endpoint:t.endpoint,api_key:t.api_key,allowed_domains:(t.allowed_domains||"").split(",").filter(Boolean).map(r=>({value:r.trim()}))}}),{fields:d,append:h,remove:j}=G({control:p,name:"allowed_domains"}),u=c("is_api_enabled"),y="https://dashbuild.berkabarindonesia.com/api/",[m,b]=i.useState(!1),[k,g]=i.useState(!1),C=()=>{const r=`${y}${c("endpoint")}`;navigator.clipboard.writeText(r),b(!0),setTimeout(()=>b(!1),2e3)},f=()=>"ak_"+((l=32)=>{const _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let M="";for(let D=0;D<l;D++)M+=_.charAt(Math.floor(Math.random()*_.length));return M})(28),v=async r=>{const l=r.allowed_domains.map(_=>_.value.trim()).filter(Boolean).join(",");console.log("Data yang akan dikirim:",{is_api_enabled:r.is_api_enabled,endpoint:r.endpoint,api_key:r.api_key,allowed_domains:l}),await w({is_api_enabled:r.is_api_enabled,endpoint:r.endpoint,api_key:r.api_key,allowed_domains:l||""})},w=async r=>{try{g(!0);const l=await q.post(`/p/${a}/entities/setting/store/${t.id}`,r);l.data.status=="success"?(N.success(l.data.message),window.location.reload()):N.error(l.data.message)}catch(l){N.error("Failed"),console.error("Error saving setting:",l)}finally{g(!1)}};return e.jsxs("form",{onSubmit:n(v),className:"shadow rounded border p-4 space-y-4",children:[e.jsxs("div",{className:"items-top flex space-x-2",children:[e.jsx(W,{id:"is_api_enabled",checked:u,onCheckedChange:r=>o("is_api_enabled",!!r)}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx("label",{htmlFor:"is_api_enabled",className:"text-sm font-medium",children:"Enable API"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow API access to share data with other systems"})]})]}),e.jsxs("div",{children:[e.jsx(P,{children:"Endpoint"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("span",{className:"text-gray-500",children:y}),e.jsx(S,{...s("endpoint"),disabled:!u,className:"disabled:bg-gray-100 flex-1 text-sm"}),e.jsx("button",{type:"button",onClick:C,disabled:!u,className:"p-1 text-gray-500 hover:text-gray-700 disabled:opacity-50",children:e.jsx(ce,{className:"w-5 h-5"})}),m&&e.jsx("span",{className:"text-green-500 text-xs",children:"Copied!"})]})]}),u&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(P,{children:"API Key"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(S,{...s("api_key"),disabled:!0,readOnly:!0,className:"bg-gray-100 flex-1 text-sm",placeholder:"Click generate to create API key"}),e.jsxs("button",{type:"button",onClick:()=>o("api_key",f()),className:"flex items-center space-x-1 p-1 text-gray-500 hover:text-gray-700",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Generate"})]})]})]}),e.jsxs("div",{children:[e.jsx(P,{children:"Allowed Domains"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Add domains that are allowed to access this API endpoint"}),d.map((r,l)=>e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx(S,{...s(`allowed_domains.${l}.value`),placeholder:"example.com",className:"flex-1"}),e.jsx(E,{type:"button",variant:"destructive",size:"icon",onClick:()=>j(l),children:e.jsx(re,{className:"w-4 h-4"})})]},r.id)),e.jsxs(E,{type:"button",variant:"secondary",size:"sm",onClick:()=>h({value:""}),children:[e.jsx(de,{className:"w-4 h-4 mr-1"})," Add Domain"]}),d.length===0&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:'No domains added. Click "Add Domain" to allow specific domains.'})]})]}),e.jsx(E,{type:"submit",size:"sm",disabled:k,children:k?"Saving...":"Save Settings"})]})},Be=({setting:t})=>{const a=O().props.current_project.uuid;return e.jsx(ne,{children:e.jsxs("div",{className:"ps-2 pe-7",children:[e.jsxs("div",{className:"mb-5",children:[e.jsxs(U,{href:`/p/${a}/entities`,className:"text-sm inline-flex items-center gap-2 mb-4 text-primary",children:[e.jsx(oe,{size:10}),"back"]}),e.jsx("h1",{className:"text-2xl font-bold",children:"Entity Setting"})]}),e.jsx(Ce,{setting:t})]})})};export{Be as default};
