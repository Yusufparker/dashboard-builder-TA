import{r as c,a as y,k as b,j as e,K as k}from"./app-bGug4RET.js";import{D as U}from"./DashboardLayout-ciBSy0q8.js";import{B as p}from"./AuthenticatedLayout-DWyVQVfr.js";import{D,p as N,a as w,b as C,c as I,d as T,e as E,f as M}from"./dialog-DkEJmaah.js";import{I as $}from"./input-BcOB6CXM.js";import{L as z}from"./label-CYd65B-p.js";import{T as L,a as A,b as g,c as u,d as B,e as x}from"./table-CvaCH-oG.js";import{T as H}from"./trash-BgPuKSZ3.js";import"./transition-DYtvxBOT.js";import"./index-BJ7M3WkV.js";import"./index-Bb0JWJun.js";import"./x-DuoEb8Gh.js";const F=i=>{const[m,r]=c.useState(!1),[l,a]=c.useState(!1),[s,n]=c.useState(!1),[h,j]=c.useState("");return{deleteMember:async(d,t)=>{try{r(!0),await y.delete(`/p/${i}/users/${d}`),b.success("Member deleted successfully"),t==null||t()}catch(o){n(!0),j((o==null?void 0:o.message)||"Failed to delete member"),b.error("Failed to delete member")}finally{r(!1)}},inviteMember:async(d,t)=>{try{a(!0),await y.post(`/p/${i}/users/invite`,{email:d}),b.success("Invitation sent"),t==null||t()}catch(o){n(!0),j((o==null?void 0:o.message)||"Failed to invite member"),b.error("Failed to invite member")}finally{a(!1)}},isDeleting:m,isInviting:l,isError:s,error:h}},P=({users:i,project_uuid:m})=>{const{deleteMember:r,isDeleting:l}=F(m),a=async s=>{await r(s,()=>{window.location.reload()})};return e.jsxs(L,{className:"text-sm w-full border border-gray-200 rounded-lg",children:[e.jsx(A,{className:"bg-gray-100",children:e.jsxs(g,{children:[e.jsx(u,{children:"No"}),e.jsx(u,{children:"Email"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Date"}),e.jsx(u,{className:"text-right"})]})}),e.jsx(B,{children:i.length>0?i.map((s,n)=>e.jsxs(g,{children:[e.jsx(x,{className:"font-medium",children:n+1}),e.jsx(x,{children:s.email}),e.jsx(x,{children:e.jsx("span",{className:`py-0.5 px-2 text-xs rounded ${s.status==="pending"?"bg-yellow-200 text-yellow-700":"bg-green-200 text-green-700"}`,children:s.status})}),e.jsx(x,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(x,{children:e.jsxs(D,{children:[e.jsx(N,{asChild:!0,children:e.jsx("button",{className:"text-red-600 hover:text-red-800 me-2",children:e.jsx(H,{size:15})})}),e.jsxs(w,{className:"sm:max-w-md",children:[e.jsxs(C,{children:[e.jsx(I,{children:"Delete User?"}),e.jsx(T,{children:"Are you sure you want to delete this user? This action cannot be undone."})]}),e.jsxs(E,{children:[e.jsx(M,{asChild:!0,children:e.jsx(p,{variant:"secondary",children:"Cancel"})}),e.jsx(p,{variant:"destructive",onClick:()=>a(s.email),disabled:l,children:l?"Deleting...":"Delete"})]})]})]})})]},s.id)):e.jsx(g,{children:e.jsx(x,{colSpan:5,className:"text-center py-4",children:"No users found."})})})]})},Y=({users:i})=>{const m=k().props.current_project.uuid,{inviteMember:r,isInviting:l}=F(m),[a,s]=c.useState(""),[n,h]=c.useState(null),j=d=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d),v=d=>{const t=d.target.value;s(t),h(j(t)?null:"Please enter a valid email address.")},f=c.useCallback(async()=>{if(!a||!j(a)){h("Please enter a valid email address.");return}await r(a,()=>{s(""),h(null),window.location.reload()})},[a,r]);return e.jsx(U,{children:e.jsxs("div",{className:"ps-2 pe-7",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"font-bold text-2xl",children:"Users"}),e.jsxs(D,{children:[e.jsx(N,{asChild:!0,children:e.jsx(p,{size:"sm",children:"+ Add New"})}),e.jsxs(w,{className:"sm:max-w-md",children:[e.jsxs(C,{children:[e.jsx(I,{children:"Invite New User"}),e.jsx(T,{children:"Enter the user's email to send an invitation."})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"grid flex-1 gap-2",children:[e.jsx(z,{htmlFor:"email",className:"sr-only",children:"Email"}),e.jsx($,{id:"email",value:a,onChange:v,placeholder:"example@mail.com",disabled:l}),n&&e.jsx("p",{className:"text-red-500 text-sm",children:n})]})}),e.jsxs(E,{className:"sm:justify-start",children:[e.jsx(M,{asChild:!0,children:e.jsx(p,{type:"button",size:"sm",variant:"secondary",children:"Close"})}),e.jsx(p,{size:"sm",onClick:f,disabled:l,children:l?"Inviting...":"Invite"})]})]})]})]}),e.jsx("div",{className:"mt-10",children:e.jsx(P,{users:i,project_uuid:m})})]})})};export{Y as default};
